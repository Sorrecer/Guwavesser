<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Guwavesser</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- judul -->
    <div class="header">
      <div class="title">
        <h1>Guwavesser</h1>
        <div class="info-container">
          <span class="info-icon">?</span>
          <div class="info-text">
            <p>How to play:</p>
            <p>1. Click "play sound" button and listen to the tone</p>
            <p>2. Guess and draw the wave in the canvas</p>
            <p>3. Click "check it" to see your accuracy</p>
          </div>
        </div>
      </div>
      <h2>Wave Guessing Game</h2>
    </div>

    <!-- wave box -->
    <div id="wave-box" class="wave-box">
      <div class="scroll-container">
        <!-- Tangga nada box -->
        <div class="notes-box">
          <div class="note sharp">G#6</div>
          <!-- Nada kres -->
          <div class="note">G6</div>
          <!-- Nada biasa -->
          <div class="note sharp">F#6</div>
          <!-- Nada kres -->
          <div class="note">F6</div>
          <!-- Nada biasa -->
          <div class="note">E6</div>
          <!-- Nada biasa -->
          <div class="note sharp">D#6</div>
          <!-- Nada kres -->
          <div class="note">D6</div>
          <!-- Nada biasa -->
          <div class="note sharp">C#6</div>
          <!-- Nada kres -->
          <div class="note">C6</div>
          <!-- Nada biasa -->
          <div class="note">B5</div>
          <!-- Nada biasa -->
          <div class="note sharp">A#5</div>
          <!-- Nada kres -->
          <div class="note">A5</div>
          <!-- Nada biasa -->
          <div class="note sharp">G#5</div>
          <!-- Nada kres -->
          <div class="note">G5</div>
          <!-- Nada biasa -->
          <div class="note sharp">F#5</div>
          <!-- Nada kres -->
          <div class="note">F5</div>
          <!-- Nada biasa -->
          <div class="note">E5</div>
          <!-- Nada biasa -->
          <div class="note sharp">D#5</div>
          <!-- Nada kres -->
          <div class="note">D5</div>
          <!-- Nada biasa -->
          <div class="note sharp">C#5</div>
          <!-- Nada kres -->
          <div class="note">C5</div>
          <!-- Nada biasa -->
          <div class="note">B4</div>
          <!-- Nada biasa -->
          <div class="note sharp">A#4</div>
          <!-- Nada kres -->
          <div class="note">A4</div>
          <!-- Nada biasa -->
          <div class="note sharp">G#4</div>
          <!-- Nada kres -->
          <div class="note">G4</div>
          <!-- Nada biasa -->
          <div class="note sharp">F#4</div>
          <!-- Nada kres -->
          <div class="note">F4</div>
          <!-- Nada biasa -->
          <div class="note">E4</div>
          <!-- Nada biasa -->
          <div class="note sharp">D#4</div>
          <!-- Nada kres -->
          <div class="note">D4</div>
          <!-- Nada biasa -->
          <div class="note sharp">C#4</div>
          <!-- Nada kres -->
          <div class="note">C4</div>
          <!-- Nada biasa -->
          <div class="note">B3</div>
          <!-- Nada biasa -->
          <div class="note sharp">A#3</div>
          <!-- Nada kres -->
          <div class="note">A3</div>
          <!-- Nada biasa -->
        </div>

        <!-- Elemen garis -->
        <div class="moving-line" id="movingLine"></div>

        <!-- drawing canvas -->
        <canvas id="drawingCanvas"></canvas>
      </div>
    </div>

    <!-- Tombol Expand -->
    <button id="expandBtn" class="expand-btn">
      <img id="expandIcon" src="down.png" alt="Expand" />
    </button>

    <!-- buttons and config -->
    <div class="rectangle-container">
      <div class="rectangle">
        <div class="segment segment1">
          <button id="play">Play Sound</button>
          <!-- slider -->
          <!-- volume slider -->
          <div class="config-container">
            <div class="volume-control">
              <label for="volume" style="font-weight: bold; margin-bottom: 10px"
                >Volume:</label
              >
              <input
                type="range"
                id="volume"
                min="0"
                max="1"
                step="0.01"
                value="0.5"
              />
              <span id="volumeValue">50%</span>
            </div>
            <div class="duration-control">
              <label
                for="duration"
                style="font-weight: bold; margin-bottom: 10px"
                >Duration:</label
              >
              <input
                type="range"
                id="duration"
                min="0.5"
                max="5"
                step="0.5"
                value="2"
              />
              <span id="durationValue">2</span>
            </div>
          </div>
        </div>
        <div class="segment segment2">
          <button id="check">Check it!</button>
          <label for="accuracy" style="font-weight: bold; margin-bottom: 10px">
            Accuracy:
          </label>
          <div class="accuracy-wrapper">
            <div id="accuracy" class="accuracy">
              <h2 style="color: black">100%</h2>
            </div>
          </div>
          <div
            id="conclusion"
            class="conclusion"
            style="font-weight: bold; display: none"
          >
            <p>WOW! you're so sigma!</p>
          </div>
          <!-- tulis statisticnya disini------------------- -->
        </div>

        <div class="segment segment3">
          <button id="reload">New Sound</button>
          <div class="config-container">
            <div class="config-item slider">
              <label for="resolution" style="margin-top: 30px"
                >Resolution:
                <div class="info-container">
                  <span class="info-icon">?</span>
                  <div class="info-text">
                    <p>Sets how smooth your drawing will be</p>
                  </div>
                </div></label
              >

              <input
                type="range"
                id="resolution"
                min="0"
                max="6"
                step="1"
                value="2"
              />
              <span id="resolutionValue">100</span>
            </div>
            <div class="config-item slider">
              <!-- Resolution Slider -->
              <label for="points"
                >Points:
                <div class="info-container">
                  <span class="info-icon">?</span>
                  <div class="info-text">
                    <p>Amount of tone point in the sound</p>
                  </div>
                </div></label
              >
              <input
                type="range"
                id="points"
                min="2"
                max="8"
                step="1"
                value="3"
              />
              <span id="pointsValue">3</span>
            </div>
            <div class="config-item dropdown">
              <!-- Pitch Difficulty Dropdown -->
              <label for="pitch"
                >Pitch Difficulty:
                <div class="info-container">
                  <span class="info-icon">?</span>
                  <div class="info-text">
                    <p>Affect the tone's range</p>
                  </div>
                </div></label
              >
              <select id="pitch">
                <option value="0.333">Easy</option>
                <option value="0.667">Medium</option>
                <option value="1" selected>Hard</option>
              </select>
            </div>
            <div class="config-item dropdown">
              <!-- Easing Dropdown -->
              <label for="easing"
                >Easing:
                <div class="info-container">
                  <span class="info-icon">?</span>
                  <div class="info-text">
                    <p>idk bout this, ask vandicco</p>
                  </div>
                </div></label
              >
              <select id="easing">
                <option value="cubic" selected>
                  Cubic Interpolation (easier)
                </option>
                <option value="ease">Ease In/Out/Inout (harder)</option>
              </select>
            </div>
            <div class="config-item dropdown">
              <!-- Line Helper Dropdown -->
              <label for="line"
                >Line Helper:
                <div class="info-container">
                  <span class="info-icon">?</span>
                  <div class="info-text">
                    <p>coming soon</p>
                  </div>
                </div></label
              >
              <select id="line">
                <option value="on">On</option>
                <option value="off" selected>Off</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card-container">
      <div class="card">
        <h3>What is this all about?</h3>
        <p>
          Have you seen a music maker or Vocaloid? In those software piano
          rolls, you can visualize <strong>pitch bend curves</strong> as they
          progress through time, creating beautiful melodies and harmonies. Our
          game takes that concept to the next level! Here, you'll interact with
          a dynamic piano roll where different tones and sounds are represented
          as waveforms. Your challenge is to accurately guess the shape and
          progression of these sound waves based on auditory clues.
        </p>

        <p>
          As you play, you‚Äôll develop a keen ear for identifying pitch, rhythm,
          and tonal nuances. The game tracks your accuracy, allowing you to
          improve your listening skills with every round. Compete against
          friends or strive for personal bests and let's see how well you can
          visualize music.
        </p>
      </div>
      <div class="card">
        <h3>How can I even know the pitch??</h3>
        <p>
          Developing perfect pitch involves training your ear to identify
          musical notes without any external reference. "To achieve this,
          consistent ear training exercises are essential, including regularly
          listening to and singing back notes, practicing interval recognition,
          and using tuning apps or interactive tools." Well, that‚Äôs what GPT
          says.
        </p>

        <p>
          Our own method to achieve this is simple: focus on one song you know
          that starts with the key of C. Why C? By establishing C as your
          reference note‚Äîthink of it as "do"‚Äîyou can compare other notes to it.
          For instance, when you hear another note, such as "mi," you'll
          eventually recognize it as the key E, because E is the third note in
          the C major scale. As you practice more, you'll develop a mental map
          of how different pitches relate to C, making it easier to identify
          them in various songs and melodies.
        </p>
      </div>
      <div class="card">
        <h3>Credits:</h3>
        <p>
          Frontend :
          <a href="https://github.com/Sorrecer/" target="_blank">Kenny</a>
        </p>
        <p>
          Backend :
          <a href="https://www.youtube.com/@CircledQuadrat" target="_blank"
            >Circled Quadrat</a
          >
        </p>
      </div>

      <div class="card">
        <h3>Are you having fun? no? Okay.. üòê</h3>
        <p>If you are, please share this to your friends üëç</p>
        <p>
          Oh, and if you're feeling generous, I'd love a
          <a href="https://buymeacoffee.com/sorrecer" target="_blank"
            >coffee boost!</a
          >
          üòÅ
        </p>
        <p>(Coffee fuels my coding adventures)</p>
      </div>
    </div>

    <div class="footer">
      <h2>@2024</h2>
    </div>

    <script src="script.js"></script>
    <script>
      // Ambil elemen tombol expand dan wave-box
      const expandBtn = document.getElementById("expandBtn");
      const waveBox = document.getElementById("wave-box");

      // Flag untuk mengetahui apakah waveBox sudah di-expand atau belum
      let isExpanded = false;

      // Tambahkan event listener pada tombol expand
      expandBtn.addEventListener("click", function () {
        if (isExpanded) {
          // Jika sudah expand, kembalikan ke ukuran awal
          waveBox.style.maxHeight = "400px";
          expandBtn.innerHTML = '<img src="down.png" alt="Expand" />'; // Ubah icon menjadi panah ke bawah
        } else {
          // Jika belum expand, ubah menjadi fit-content
          waveBox.style.maxHeight = "fit-content";
          expandBtn.innerHTML = '<img src="up.svg" alt="Collapse" />'; // Ubah icon menjadi panah ke atas
        }

        // Toggle status expanded
        isExpanded = !isExpanded;
      });

      // Ambil elemen tombol "check" dan elemen "accuracy"
      const checkBtn = document.getElementById("check");
      const accuracy = document.getElementById("accuracy");
      const reloadBtn = document.getElementById("reload");

      // Event listener untuk tombol "check"
      checkBtn.addEventListener("click", function () {
        // Hitung akurasi
        const score = Math.floor(calculateScore(nowWave, nowAns) * 100) / 100;
        accuracy.textContent =
          Math.floor(calculateScore(nowWave, nowAns) * 100) / 100 + "%";

        // Sesuaikan lebar sesuai akurasi (proposional dari 80%)
        const widthPercentage = (score / 100) * 80; // 80% adalah lebar max dari box
        accuracy.style.width = widthPercentage + "%";

        // Ubah background gradient agar sesuai dengan score
        const gradientPercentage = score / 100; // Adjust color gradient based on score
        accuracy.style.background = `linear-gradient(to right, #00ff00, #ffff00 ${gradientPercentage}%, #ff0000)`;

        // Tampilkan elemen accuracy dengan animasi
        accuracy.classList.add("visible");

        // Ubah teks kesimpulan berdasarkan nilai akurasi
        let conclusionText = "";
        if (score < 40) {
          conclusionText = "Are you even trying";
        } else if (score >= 40 && score <= 60) {
          conclusionText = "Not bad for beginners";
        } else if (score > 60 && score <= 70) {
          conclusionText =
            "Not bad, could have been better if you paid more attention";
        } else if (score > 70 && score <= 80) {
          conclusionText = "I'm proud of you";
        } else if (score > 80 && score <= 95) {
          conclusionText = "Brilliant.";
        } else if (score > 95 && score < 100) {
          conclusionText = "Maybe try harder config";
        } else if (score == 100) {
          conclusionText = "Nice hack";
        }

        // Update kesimpulan dan tampilkan
        conclusion.querySelector("p").textContent = conclusionText;
        conclusion.style.display = "block"; // Tampilkan kesimpulan
      });

      reloadBtn.addEventListener("click", function () {
        // Hilangkan animasi dan reset akurasi
        accuracy.classList.remove("visible");
        accuracy.style.width = "0"; // Reset lebar ke 0%
        accuracy.style.background = ""; // Reset gradient background

        // Sembunyikan kesimpulan
        conclusion.style.display = "none"; // Sembunyikan kesimpulan lagi
      });
    </script>
    <script>
      // Get all card elements
      const cards = document.querySelectorAll(".card");

      // Loop through each card and add a click event listener
      cards.forEach((card) => {
        card.addEventListener("click", () => {
          // Toggle the 'expanded' class on click
          card.classList.toggle("expanded");
        });
      });
    </script>
  </body>
</html>
